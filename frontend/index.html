<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; connect-src 'self' http://localhost:8000 ws://localhost:8000; img-src 'self' data: blob:">
  <title>Eaglearn Dashboard</title>
  <link rel="stylesheet" href="styles-tokens.css">
  <link rel="stylesheet" href="styles-figma.css">
</head>
<body class="app-shell">
  <aside class="sidebar" aria-label="Navigasi utama">
    <div class="sidebar__brand">
      <div class="sidebar__logo" aria-hidden="true">EL</div>
      <span class="sidebar__title">Eaglearn</span>
    </div>
    <nav class="sidebar__nav" aria-label="Main navigation">
      <button class="sidebar__nav-item is-active" id="nav-dashboard" type="button" aria-label="Dashboard">Dashboard</button>
      <button class="sidebar__nav-item" id="nav-analytics" type="button" aria-label="Analitik">Analitik</button>
      <button class="sidebar__nav-item" id="nav-calibration" type="button" aria-label="Kalibrasi">Kalibrasi</button>
      <button class="sidebar__nav-item" id="nav-settings" type="button" aria-label="Pengaturan">Pengaturan</button>
    </nav>
  </aside>

  <div class="app-content">
    <header class="topbar" role="banner">
      <div class="topbar__cluster">
        <div class="topbar__label">Status Sistem</div>
        <div class="topbar__badge" data-status-indicator>
          <span id="session-status" data-state="idle">Idle</span>
        </div>
        <div class="topbar__ws" id="ws-state">WS: offline</div>
      </div>
      <div class="topbar__actions">
        <button id="open-calibration-btn" class="btn btn-secondary" type="button">Kalibrasi</button>
        <button id="start-session-btn" class="btn btn-primary" type="button">Mulai Sesi</button>
        <button id="stop-session-btn" class="btn btn-danger" type="button" disabled>Akhiri</button>
      </div>
    </header>

    <main class="content-main" role="main">
      <section class="kpi-grid" aria-label="Ringkasan metrik utama">
        <article class="kpi-card" data-kpi="focus_score">
          <header>
            <h2>Fokus</h2>
          </header>
          <div class="kpi-card__body">
            <span class="kpi-card__value" data-kpi-value="focus_score">0</span>
            <span class="kpi-card__delta" data-kpi-delta="focus_score">0%</span>
          </div>
        </article>
        <article class="kpi-card" data-kpi="stress_score">
          <header>
            <h2>Stress</h2>
          </header>
          <div class="kpi-card__body">
            <span class="kpi-card__value" data-kpi-value="stress_score">0</span>
            <span class="kpi-card__delta" data-kpi-delta="stress_score">0%</span>
          </div>
        </article>
        <article class="kpi-card" data-kpi="posture_score">
          <header>
            <h2>Postur</h2>
          </header>
          <div class="kpi-card__body">
            <span class="kpi-card__value" data-kpi-value="posture_score">0</span>
            <span class="kpi-card__delta" data-kpi-delta="posture_score">0%</span>
          </div>
        </article>
        <article class="kpi-card" data-kpi="engagement_score">
          <header>
            <h2>Engagement</h2>
          </header>
          <div class="kpi-card__body">
            <span class="kpi-card__value" data-kpi-value="engagement_score">0</span>
            <span class="kpi-card__delta" data-kpi-delta="engagement_score">0%</span>
          </div>
        </article>
        <article class="kpi-card" data-kpi="overall_productivity">
          <header>
            <h2>Produktivitas</h2>
          </header>
          <div class="kpi-card__body">
            <span class="kpi-card__value" data-kpi-value="overall_productivity">0</span>
            <span class="kpi-card__delta" data-kpi-delta="overall_productivity">0%</span>
          </div>
        </article>
      </section>

      <section class="panel-grid">
        <section class="panel" aria-labelledby="trend-title">
          <header class="panel__header">
            <div>
              <span class="panel__eyebrow">Analitik Real-time</span>
              <h2 class="panel__title" id="trend-title">Tren Terkini</h2>
            </div>
            <button id="refresh-trend-btn" class="btn btn-ghost" type="button">Refresh</button>
          </header>
          <div class="panel__body">
            <canvas id="trend-chart" width="600" height="220" aria-label="Grafik tren metrik"></canvas>
            <ul id="trend-list" class="trend-list" aria-live="polite"></ul>
          </div>
        </section>

        <section class="panel" aria-labelledby="summary-title">
          <header class="panel__header">
            <div>
              <span class="panel__eyebrow">Ringkasan Sesi</span>
              <h2 class="panel__title" id="summary-title">5 Sesi Terakhir</h2>
            </div>
            <button id="refresh-summary-btn" class="btn btn-ghost" type="button">Refresh</button>
          </header>
          <div class="panel__body">
            <ul class="session-list" data-session-summary></ul>
          </div>
        </section>

        <section class="panel" aria-labelledby="resource-title">
          <header class="panel__header">
            <div>
              <span class="panel__eyebrow">Kondisi Perangkat</span>
              <h2 class="panel__title" id="resource-title">Pemakaian Sumber Daya</h2>
            </div>
          </header>
          <div class="panel__body panel__body--split">
            <div class="resource-card">
              <span class="resource-card__label">CPU</span>
              <span class="resource-card__value"><span id="cpu-usage">0</span>%</span>
            </div>
            <div class="resource-card">
              <span class="resource-card__label">RAM</span>
              <span class="resource-card__value"><span id="ram-usage">0</span> MB</span>
            </div>
          </div>
        </section>
      </section>

      <section class="panel webcam-panel" aria-labelledby="webcam-title">
        <header class="panel__header">
          <h2 class="panel__title" id="webcam-title">Live Preview</h2>
        </header>
        <div class="panel__body">
          <div class="webcam-container">
            <video id="webcam-view" autoplay muted playsinline></video>
            <canvas id="skeleton-overlay"></canvas>
          </div>
        </div>
      </section>
    </main>
  </div>

  <div id="alert-container" class="alert-container" aria-live="polite" aria-atomic="true"></div>

  <div id="calibration-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="calibration-title">
    <div class="modal__panel">
      <header class="modal__header">
        <h2 id="calibration-title">Kalibrasi Pengguna</h2>
        <button id="calibration-close" class="btn btn-ghost" type="button" aria-label="Tutup kalibrasi">&times;</button>
      </header>
      <ol id="calibration-steps" class="modal__steps"></ol>
      <footer class="modal__footer">
        <button id="calibration-action" class="btn btn-primary" type="button" data-step="start">Mulai</button>
      </footer>
    </div>
  </div>

  <div id="notification-region" class="notification-region" aria-live="polite" aria-atomic="true"></div>

  <script src="ws-client.js"></script>
  <script src="renderer.js"></script>
</body>
</html>
